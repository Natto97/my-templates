id: CVE-2022-22965

info:
  name: Spring Framework RCE via Data Binding on JDK 9+ (Spring4Shell)
  author: Natto97
  severity: critical
  tags: cve,rce

requests:
  - method: GET
    path:
      - "{{RootURL}}/?class.module.classLoader.URLs%5B0%5D=0"
    headers:
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
    matchers:
      - type: word
        words:
          - "error (type=Bad Request, status=400)"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8

    body: |
      class.module.classLoader.URLs%5B0%5D=0
    matchers:
    - type: word
      words:
        - "error (type=Bad Request, status=400)"
      part: body
